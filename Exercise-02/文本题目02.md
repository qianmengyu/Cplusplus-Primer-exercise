# 第2章 文本题目

## 2-1

类型int、long、long long和short的区别是什么？无符号类型和带符号类型的区别是什么？float和double的区别是什么？

- 解

1. int、long、long long和short均为整型，但规定的尺寸最小值不同
2. 大多数整型都可以分为无符号整型和带符号整型，无符号整型中所有bite都用来存储数值，但仅能表示大于等于0的数值；而带符号整型通常有bite作为符号位，可以表示正数、负数和0
3. float和double分别为单精度浮点数和双精度浮点数，在内存中占的bite数不同，规定的有效位数也不同

## 2-2

计算按揭贷款时，利率、本金和付款分别应选择何种数据类型？

- 解

利率、本金和付款都可能是实数，应选择浮点数表示，一般double类型即可

## 2-5

字面值的数据类型  

1. 'a', L'a', "a", L"a"
2. 10, 10u, 10L, 012, 0xC
3. 3.14, 3.14f, 3.14L
4. 10, 10u, 10., 10e-2

- 解

1. 字符a，宽字符wchar_t类型a，字符串a，宽字符串
2. int 10，无符号10，long 10，八进制数10，十六进制10
3. 浮点类型字面值3.14，float 3.14，long double 3.14
4. 10，unsigned 10，浮点数10.，科学计数法0.1

## 2-7

字面值含义

1. 1024f

- 解

整数接f有些编译器可能报错，需要改为1024.f

## 2-9

初始化是否非法

1. std::cin >> int a;
2. int i = {3.14};
3. double s = w = 9999.99;
4. int i = 3.14;

- 解

1. cin需要一个明确的变量名称，而不是未定位的，应该先int后cin
   - int a;
   - std::cin >> a;
2. 列表初始化遇到数据丢失会报错，应该int i = {3};
3. 声明语句多个变量应该用逗号分别初始化，不能用=直接连接
4. warning，小数部分会丢失

## 2-10

下列变量的初值分别是什么？

``` C++
std::string global_str;
int global_int;
int main()
{
    int local_int;
    std::string local_str;
}
```

- 解

string类型接受无参数的初始化方法，定义在函数内和函数外都默认初始化为空串。global_str、local_str初始化空串。
内置类型int要看在函数体内部还是外部，函数体外global_int初始化为0，函数体内local_int不初始化。

## 2-11

解释一下是定义还是声明declaration

1. extern int ix = 1024;
2. int iy;
3. extern int iz;

- 解

1. 定义（有初始化赋值）
2. 定义
3. 声明

## 2-12

请指出下面的名字中哪些是非法的？

(a) int double = 3.14;  
(b) int _;  
(c) int catch-22;  
(d) int 1_or_2 = 1;  
(e) double Double = 3.14;

- 解

（a）使用关键字作为名称，非法。  
（c）使用'-'符号，非法。
（d）使用数字而不是字母或_开头，非法。

## 2-13

下面程序中j的值是多少？

``` C++
int i = 42;
int main()
{
    int i = 100;
    int j = i;
}
```

- 解

100，实际使用的内部定义的局部变量i对j初始化

## 2-15

以下哪个定义不合法？  
(a) int ival = 1.01;  
(b) int &rval1 = 1.01;  
(c) int &rval2 = ival;  
(d) int &rval3;  

- 解

（b）一般的引用必须指向对象，不能指向常量或者表达式  
（d）一般的引用必须初始化  

## 2-16

下面哪些赋值是合法的？

```C++
int i = 0, &r1 = i; 
double d = 0, &r2 = d;
```

(a) r2 = 3.14159;  
(b) r2 = r1;  
(c) i = r2;  
(d) r1 = d;  

- 解

（a）合法，正常赋值给d  
（b）合法，以r1引用的i的值赋值给r2引用的d  
（c）合法，以r2引用的d赋值给i，double类型有窄化操作  
（d）合法，以d赋值给r1引用的i，double类型有窄化操作  

## 2-21

解释下述定义。在这些定义中有非法的吗？

```C++
int i = 0;
```

(a) ```double* dp = &i;```  
(b) ```int *ip = i;```  
(c) ```int *p = &i;```

- 解

（a）指针类型和对象类型不一致
（b）缺少取址符&

# 2-22

p是int型指针，解释代码含义

``` C++
if(p){}
if(*p){}
```

- 解
第一个表示p是否已经指向某个真实存在的对象，指向则p代表地址，于bool值为ture，没有指向对象或者无效指针为false  
第二个表示p指向的int对象是否为0，是为true  

## 2-23

给定指针p，如何判断是否指向合法对象？

- 解

直接用if(p)判断即可，如果p指向合法对象，其bool含义为true。最好将其置于try结构中，以防未初始化造成错误结果。

## 2-24

下文程序为何p合法而lp非法？

```C++
int i = 42;
void *p = &i;
long *lp = &i;
```

- 解

void* 是从C继承来的，可以指向任意类型的对象的指针。lp是long型指针，不能指向int类型对象。

## 2-25

说明下列变量的类型和值

```C++
(a) int* ip, i, &r = i;
(b) int i, *ip = 0;
(c) int* ip, ip2;
```

- 解

（a）ip是未初始化的int指针；i整型；r是整型引用指向i。  
（b）i整型；ip是int类型空指针。  
（c）ip是未初始化的int指针；ip2是整型

## 2-26

下面哪些句子是合法的？

```C++
(a) const int buf;
(b) int cnt = 0;
(c) const int sz = cnt;
(d) ++cnt; ++sz;
```

- 解

（a）不合法，const类型必须初始化，后续值固定。  
（b）合法。  
（c）合法。  
（d）不合法，const类型的sz不能修改。

## 2-27

下面哪些初始化是合法的？

```C++
(a) int i = -1, &r = 0;
(b) int *const p2 = &i2;
(c) const int i = -1, &r = 0;
(d) const int *const p3 = &i2;
(e) const int *p1 = &i2;
(f) const int &const r2;
(g) const int i2 = i, &r = i;
```

- 解

（a）不合法，引用r必须初始化，且不能初始化为字面值常量或表达式。  
（b）合法，常量指针p2初始化，永远指向i2。  
（c）合法，常量引用r必须初始化，但可以初始化为字面值常量或计算式结果。  
（d）合法，常量指针p3指向常量对象i2，p3永远指向i2，且不能通过指针p3修改i2的值（如果i2不是const int实际可以通过其他方式改变i2值，但不能通过p3）。  
（e）合法，指针p1指向常量对象i2，不能通过指针p1修改i2的值（如果i2不是const int实际可以通过其他方式改变i2值，但不能通过p1）。  
（f）非法，没有常量引用&const类型，引用不是对象。  
（g）合法，常量i2，常量int的引用r指向const int i。

## 2-28

说明下列定义

```C++
(a) int i, *const cp;
(b) int *p1, *const p2;
(c) const int ic, &r = ic;
(d) const int *const p3;
(e) const int *p;
```

- 解

（a）非法，常量指针```*const```必须初始化，其指向对象永远不变。  
（b）非法，常量指针```*const```必须初始化，其指向对象永远不变。  
（c）非法，常量整型ic必须初始化。  
（d）非法，常量指针```*const```必须初始化，其指向对象永远不变。  
（e）合法，指向常量整型的指针p。

## 2-29

假设已有上一题变量，下面哪些语句是合法的？

```C++
(a) i = ic;
(b) p1 = p3;
(c) p1 = &ic;
(d) p3 = &ic;
(e) p2 = p1;
(f) ic = *p3;
```

- 解

（a）合法，常量整型给整型赋值。  
（b）非法，普通指针指向const int，常量对象只能由指向常量```const int*```的指针指向。  
（c）非法，普通指针指向const int，常量对象只能由指向常量```const int*```的指针指向。  
（d）非法，常量指针```*const```不能更改指向对象。  
（e）非法，常量指针```*const```不能更改指向对象。  
（f）非法，常量对象不能修改。

## 2-30

判断语句中对象是顶层const还是低层const

```C++
const int v2 = 0; int v1 = v2;
int *p1 = &v1, &r1 = v1;
const int *p2 = &v2, *const p3 = &i, &r2 = v2;
```

- 解

v2和p3是顶层const，表示其本身是常量（常量整型和常量指针）；p2和r2是底层const，表示其指向的对象是常量类型（常量整型）。

## 2-31

已有上面语句，下面哪些语句是合法的？

```C++
(a) r1 = v2;
(b) p1 = p2;
(c) p2 = p1;
(d) p1 = p3;
(e) p2 = p3;
```

- 解
  - 赋值时顶层不太重要，底层比较重要。

（a）合法，非常量引用r1，相当于v2的值赋给v1。  
（b）非法，p2是底层const，指向常量对象，令p1指向p2所指对象，可能会修改p2所指对象。  
（c）合法，p2是底层const，指向常量对象，但将其指向非常量对象是可以的，只是不能通过p2修改对象的值。  
（d）非法，p3是顶层const，但p3也包含底层const，不能赋值给普通指针。  
（e）合法，p2是底层const，指向常量对象，但将其指向常量对象是可以的，p2和p3具有相同的底层。  

## 2-32

下面代码是否合法

```C++
int null = 0, *p = null;
```

- 解

不合法，指针p应该初始化为地址，可以改为```*p = &null;```或```*p = nullptr;```

## 2-33

根据本节定义的变量，判断下列语句的运行结果

```C++
(a) a=42;
(b) b=42;
(c) c=42;
(d) d=42;
(e) e=42;
(f) g=42;
```

- 解

```C++
int i = 0, &r = i;
auto a = r;                   // int

const int ci = i, &cr = ci;   // const int 和 const int的引用
auto b = ci;                  // 推断为int，顶层const被忽略
auto c = cr;                  // 推断为int，引用推断为ci，ci顶层const被忽略
auto d = &i;                  // 整型的指针，指向int
auto e = &ci;                 // 整型常量的指针，指向const int
const auto f = ci;            // 整型常量const int
auto &g = ci;                 // 整型常量的引用（普通，不能初始化为字面值）
```

（a）a改为42
（b）b改为42
（c）c改为42
（d）d为整型指针，不能赋字面值
（e）e为整型常量的指针，不能赋字面值
（f）g是整型常量的引用，不能赋值


## 2-

？

```C++
(a) 
(b) 
(c) 
(d) 
(e) 
(f) 
(g) 
```

- 解

（a）
（b）
（c）
（d）
（e）
（f）
（g）
